name: PDF Generation
run-name: Generating PDF Document
on: [push]
#  push:
#    branches:
#      - master

permissions: 
  contents: write

jobs:
  Build-and-Deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Start
        run: |
          echo "🐧 This job is now running on a ${{ runner.os }} server hosted by GitHub!"
          echo "🔎 The name of branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      - name: Checkout
        uses: actions/checkout@v3
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - name: Build Environment Setup 🏗️
        run: |
          sudo apt-get -qq update
          sudo apt-get install -y texlive-full
      - name: Create artifact directory
        run: mkdir public
      - name: Generate Resume PDF 📜
        run: |
          cd src/resume/
          ls -la
          xelatex resume.tex \resume
          ls -la
          if [ ! -f "resume.pdf" ]; then echo "Resume PDF not found"; exit 1; fi
          cp ./resume.pdf ../../public/Adisakshya_Chauhan_Resume.pdf 
          cd ../../public
          ls -la
      - name: Generate CV PDF 📜
        run: |
          cd src/cv/
          mkdir public
          ls -la
          xelatex cv.tex \cv
          ls -la
          if [ ! -f "cv.pdf" ]; then echo "CV PDF not found"; exit 1; fi
          cp ./cv.pdf ../../public/Adisakshya_Chauhan_CV.pdf 
          cd ../../public
          ls -la
      - name: Push to GitHub Pages 🚀
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: src/public