name: PDF Gneration
run-name: Generating PDF Document
on: [push]

permissions: 
  contents: write

jobs:
  Build-PDF:
    runs-on: ubuntu-latest
    steps:
      - name: Start
        run: |
          echo "üêß This job is now running on a ${{ runner.os }} server hosted by GitHub!"
          echo "üîé The name of branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      - name: Checkout
        uses: actions/checkout@v3
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - name: Build Environment Setup
        uses: awalsh128/cache-apt-pkgs-action@latest
        with:
          packages: texlive-full
          version: 1.0
      - name: Generate PDF
        run: |
          cd src
          mkdir public
          ls -la
          xelatex cv.tex \cv
          ls -la
          if [ ! -f "cv.pdf" ]; then echo "CV PDF not found"; exit 1; fi
          cp ./cv.pdf ./public/Adisakshya_Chauhan_CV.pdf 
          cd public
          ls -la
          echo "üçè This job's status is ${{ job.status }}."
      - name: Deploy to GitHub Pages
        uses: crazy-max/ghaction-github-pages@v4
        with:
          target_branch: gh-pages
          build_dir: public
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
